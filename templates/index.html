<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Med-AI Assistant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.11/dist/dotlottie-wc.js" type="module"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<div class="app-wrapper">
    <aside class="sidebar">
        <div class="brand d-flex align-items-center gap-0">
            MedChat
            <dotlottie-wc src="https://lottie.host/44f5c3e7-8352-438c-912d-61d78a0ac716/xZgpLeIjtf.lottie" autoplay loop></dotlottie-wc>  
        </div>

        <div class="search-box">
            <i class="fa fa-search"></i>
            <input type="text" placeholder="Search chats">
        </div>

        <nav class="nav flex-column mt-4">
			<a class="nav-link active"><i class="fa fa-question-circle"></i> Common Questions</a>
            <a class="nav-link" onclick="setMessage('How to cure headache?')"><i class="fa fa-stethoscope"></i> How to cure headache?</a>
			<a class="nav-link" onclick="setMessage('Am I dying quickly if I drink coffee everyday?')"><i class="fa fa-stethoscope"></i> Does coffee cause higher risk of death?</a>
			<a class="nav-link" onclick="setMessage('What are the early sign and symptoms of brain tumor?')"><i class="fa fa-stethoscope"></i> Brain tumor symptoms?</a>
		            
    </aside>

    <main class="main-content">

        <div class="hero-section text-center d-flex flex-column justify-content-center align-items-center";">
            <div class="orb"></div>
            <h2 class="hero-subtitle">Welcome to MedChat!ðŸ‘‹</h2>
            <p class="hero-subtitle">Your personal medical assistant. Can I help you with anything?</p>
        </div>

        <div class="messages-container" id="messageFormeight"></div>

        <div class="chat-input-container">
            <form id="messageArea" class="chat-input-form">
                <input type="text" id="text" name="msg"
                       placeholder="Type your message here..."
                       autocomplete="off" required>
                <button type="submit">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
        </div>

    </main>

</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
$(document).ready(function() {

    window.setMessage = function(message) {
        $("#text").val(message);
        $("#messageArea").trigger("submit");
    };

    $("#messageArea").on("submit", function(event) {
        event.preventDefault();

        var rawText = $("#text").val();
        if (!rawText.trim()) return;

        const date = new Date();
        const hour = date.getHours();
        const minute = date.getMinutes().toString().padStart(2, '0');
        const str_time = hour + ":" + minute;

        if (!$("body").hasClass("chat-active")) {
            $("body").addClass("chat-active");
        }

        var userHtml = `
            <div class="message user">
                <div class="bubble">
                    ${rawText}
                    <span class="timestamp">${str_time}</span>
                </div>
            </div>`;
        $("#messageFormeight").append(userHtml);
        $("#text").val("");

        // Append typing indicator
        var typingHtml = `
            <div class="message bot" id="typing-indicator">
                <div class="typing-indicator">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>`;
        $("#messageFormeight").append(typingHtml);
        $("#messageFormeight").scrollTop($("#messageFormeight")[0].scrollHeight);

        $.ajax({
            data: { msg: rawText },
            type: "POST",
            url: "/get",
        }).done(function(data) {

            $("#typing-indicator").remove();

            var botHtml = `
                <div class="message bot">
                    <div class="bubble">
                        ${data}
                        <span class="timestamp">${str_time}</span>
                    </div>
                </div>`;

            $("#messageFormeight").append(botHtml);
           
        });
    });

});
</script>


</body>
</html>